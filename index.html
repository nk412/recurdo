<!DOCTYPE html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width, initial-scale=1.0"><title>recurdo</title><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Lexend:wght@100..900&display=swap" rel=stylesheet><style>:root{--primary-color:#333;--accent-color:#4285f4;--accent-hover:#2a75f3;--light-bg:#f5f5f5;--dark-bg:#222;--border-color:#ddd;--text-color:#333;--text-muted:#777;--button-primary:#ffca28;--button-primary-hover:#ffb300}*{box-sizing:border-box;margin:0;padding:0;font-family:"Lexend",sans-serif}.neucha-regular{font-family:"Neucha",cursive;font-weight:400;font-style:normal}body{background-color:#fff;color:var(--text-color);line-height:1.6;padding-bottom:60px}header{padding:20px;padding-bottom:10px;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid var(--border-color)}.logo{display:flex;align-items:center;font-size:24px;font-weight:bold;color:var(--primary-color)}.logo::before{content:"↻";margin-right:8px;font-size:22px}.nav-tabs{display:flex;margin:25px 0 3em 0;gap:10px}.tab{padding:8px 16px;border:1px solid var(--border-color);border-radius:4px;background-color:#fff;cursor:pointer;transition:all .2s}.tab.active{background-color:var(--dark-bg);color:white}.tab:hover:not(.active){background-color:var(--light-bg)}.container{max-width:800px;margin:0 auto;padding:0 20px}header .container{display:flex;justify-content:space-between;align-items:center;width:100%}.task-list{margin-top:20px}.task-item{display:flex;align-items:center;padding:2px 0;margin-bottom:8px}.task-item:hover{background-color:rgba(240,240,240,0.9);border-radius:4px}.task-icon{margin-right:10px;font-size:20px}.task-content{flex-grow:1}.task-title{font-size:16 px;font-weight:500;color:var(--accent-color)}.task-title.completed{text-decoration:line-through;color:var(--text-muted)}.task-title a{text-decoration:none;color:var(--accent-color)}.task-title a:hover{text-decoration:underline}.task-frequency{font-size:14px;color:var(--text-muted);margin-left:5px;display:inline-block;padding:2px 6px;background-color:#f0f0f0;border-radius:4px}.task-description{font-size:14px;color:var(--text-color);margin-top:4px}.task-buttons{display:flex;gap:6px}button{padding:6px 12px;background-color:#fff;border:1px solid var(--border-color);border-radius:4px;cursor:pointer;font-size:14px;transition:all .2s}button:hover{background-color:var(--light-bg)}.status-message{margin:20px 0;font-size:18px;color:var(--text-color)}.add-task-form{background-color:var(--light-bg);border-radius:8px;padding:20px;margin-top:20px}.form-group{margin-bottom:15px}label{display:block;margin-bottom:5px;font-weight:500}input[type="text"],textarea,select{width:100%;padding:8px 12px;border:1px solid var(--border-color);border-radius:4px;font-size:16px}.frequency-options{margin-top:10px;display:none}.frequency-options.show{display:block}.checkbox-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:8px;margin-top:10px}.month-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:5px;margin-top:10px}.checkbox-label{display:flex;align-items:center;font-size:14px}.submit-btn{background-color:var(--accent-color);color:white;border:0;padding:10px 16px;border-radius:4px;font-size:16px;cursor:pointer;transition:background-color .2s}.submit-btn:hover{background-color:var(--accent-hover)}.hidden{display:none}.task-details{padding:20px;background-color:var(--light-bg);border-radius:8px;margin-top:20px}.back-link{display:inline-block;margin-top:10px;color:var(--accent-color);text-decoration:none}.back-link:hover{text-decoration:underline}.edit-link{color:var(--accent-color);margin-left:10px;text-decoration:none;font-size:14px}.edit-link:hover{text-decoration:underline}@media(max-width:600px){.checkbox-grid,.month-grid{grid-template-columns:repeat(4,1fr)}}.hamburger-menu{position:relative;display:inline-block;margin-left:auto}.hamburger-icon{font-size:24px;cursor:pointer;padding:8px;color:var(--primary-color)}.menu-dropdown{display:none;position:absolute;right:0;background-color:white;min-width:180px;box-shadow:0 8px 16px 0 rgba(0,0,0,0.2);z-index:1;border-radius:4px}.menu-dropdown a{color:var(--text-color);padding:12px 16px;text-decoration:none;display:block;border-bottom:1px solid var(--border-color)}.menu-dropdown a:last-child{border-bottom:0}.menu-dropdown a:hover{background-color:var(--light-bg)}.show-menu{display:block}.modal-overlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.5);z-index:100;align-items:center;justify-content:center}.modal-content{background-color:white;padding:20px;border-radius:8px;max-width:500px;width:90%;position:relative}.modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px}.modal-close{cursor:pointer;font-size:24px}.modal-body{margin-bottom:20px}</style></head><body><header><div class=container><div class=logo>recurdo</div><div class=hamburger-menu><div class=hamburger-icon>☰</div><div class=menu-dropdown><a href=# id=about-app>About</a><a href=# id=download-tasks>Download all tasks</a><a href=# id=upload-tasks>Upload tasks</a></div></div></div></header><div class=container><div class=nav-tabs><button class="tab active" data-view=today>Today</button><button class=tab data-view=add>Add New</button><button class=tab data-view=all>View All</button></div></div><div class=container><div id=today-view class=view><div class=status-message id=today-status></div><div class=task-list id=today-tasks></div><br><br><br><div class=upcoming-section><h3>Upcoming</h3><div class=task-list id=upcoming-tasks></div></div></div><div id=add-view class="view hidden"><div class=add-task-form><h2>Add New Task</h2><form id=task-form><div class=form-group><label for=task-title>Task Title</label><input type=text id=task-title required></div><div class=form-group><label for=task-description>Description (optional)</label><textarea id=task-description rows=3></textarea></div><div class=form-group><label for=task-frequency>Frequency</label><select id=task-frequency required><option value>Select frequency</option><option value=daily>Daily</option><option value=weekly>Weekly</option><option value=monthly>Monthly</option><option value=quarterly>Quarterly</option><option value=yearly>Yearly</option><option value=custom_interval>Custom Interval</option></select></div><div id=daily-options class=frequency-options></div><div id=weekly-options class=frequency-options><label>Select days of the week:</label><div class=checkbox-grid><label class=checkbox-label><input type=checkbox name=weekday value=0> Sun </label><label class=checkbox-label><input type=checkbox name=weekday value=1> Mon </label><label class=checkbox-label><input type=checkbox name=weekday value=2> Tue </label><label class=checkbox-label><input type=checkbox name=weekday value=3> Wed </label><label class=checkbox-label><input type=checkbox name=weekday value=4> Thu </label><label class=checkbox-label><input type=checkbox name=weekday value=5> Fri </label><label class=checkbox-label><input type=checkbox name=weekday value=6> Sat </label></div></div><div id=monthly-options class=frequency-options><label>Select days of the month:</label><div class=month-grid id=month-days-grid></div></div><div id=quarterly-options class=frequency-options><label>Select days of each quarter:</label><div class=month-grid id=quarter-days-grid></div><p class=hint>Select days 1-90 (representing days in each quarter)</p></div><div id=yearly-options class=frequency-options><div class=form-group><label for=yearly-month>Month:</label><select id=yearly-month><option value=0>January</option><option value=1>February</option><option value=2>March</option><option value=3>April</option><option value=4>May</option><option value=5>June</option><option value=6>July</option><option value=7>August</option><option value=8>September</option><option value=9>October</option><option value=10>November</option><option value=11>December</option></select></div><div class=form-group><label for=yearly-day>Day:</label><select id=yearly-day></select></div></div><div id=custom_interval-options class=frequency-options><div class=form-group><label for=interval-days>Days between occurrences:</label><input type=number id=interval-days min=1 value=7></div></div><button type=submit class=submit-btn>Add Task</button></form></div></div><div id=all-view class="view hidden"><h2>All Tasks</h2><div class=task-list id=all-tasks></div></div><div id=edit-view class="view hidden"></div><div id=details-view class="view hidden"></div></div><div class=modal-overlay id=about-modal><div class=modal-content><div class=modal-header><h2>About ↻</h2><span class=modal-close>&times;</span></div><div class=modal-body><p><b>Recurdo</b> is a todo task tracker exclusively for recurring tasks.</p><br><p>Use it for habit building, tracking odd schedules, or remembering your neighbor's cat's birthday (if you're so inclined).</p><br><p>Nothing leaves the browser. All data is yours.</p></div></div></div><script>document.addEventListener('DOMContentLoaded',function(){const tabs=document.querySelectorAll('.tab');const views=document.querySelectorAll('.view');const taskForm=document.getElementById('task-form');const taskFrequency=document.getElementById('task-frequency');const frequencyOptions=document.querySelectorAll('.frequency-options');const todayTasks=document.getElementById('today-tasks');const allTasks=document.getElementById('all-tasks');const todayStatus=document.getElementById('today-status');const yearlyMonth=document.getElementById('yearly-month');const yearlyDay=document.getElementById('yearly-day');const editView=document.getElementById('edit-view');const detailsView=document.getElementById('details-view');const monthDaysGrid=document.getElementById('month-days-grid');const quarterDaysGrid=document.getElementById('quarter-days-grid');const hamburgerIcon=document.querySelector('.hamburger-icon');const menuDropdown=document.querySelector('.menu-dropdown');const downloadTasksLink=document.getElementById('download-tasks');const uploadTasksLink=document.getElementById('upload-tasks');const aboutAppLink=document.getElementById('about-app');const aboutModal=document.getElementById('about-modal');const modalClose=document.querySelector('.modal-close');hamburgerIcon.addEventListener('click',function(){menuDropdown.classList.toggle('show-menu');});window.addEventListener('click',function(e){if(!e.target.matches('.hamburger-icon')){if(menuDropdown.classList.contains('show-menu')){menuDropdown.classList.remove('show-menu');}}});downloadTasksLink.addEventListener('click',function(e){e.preventDefault();const tasks=localStorage.getItem('recurdo-tasks')||'[]';const history=localStorage.getItem('recurdo-history')||'{}';const exportData={tasks:JSON.parse(tasks),history:JSON.parse(history),exportDate:new Date().toISOString()};const dataStr=JSON.stringify(exportData,null,2);const dataUri='data:application/json;charset=utf-8,'+encodeURIComponent(dataStr);const exportFileDefaultName='tasks.recurdo';const linkElement=document.createElement('a');linkElement.setAttribute('href',dataUri);linkElement.setAttribute('download',exportFileDefaultName);linkElement.click();menuDropdown.classList.remove('show-menu');});uploadTasksLink.addEventListener('click',function(e){e.preventDefault();const fileInput=document.createElement('input');fileInput.type='file';fileInput.accept='.recurdo,application/json';fileInput.addEventListener('change',function(e){const file=e.target.files[0];if(!file)return;const reader=new FileReader();reader.onload=function(e){try{const data=JSON.parse(e.target.result);if(!data.tasks||!Array.isArray(data.tasks)){throw new Error('Invalid tasks data format');}
if(confirm('This will replace your current tasks. Continue?')){localStorage.setItem('recurdo-tasks',JSON.stringify(data.tasks));if(data.history&&typeof data.history==='object'){localStorage.setItem('recurdo-history',JSON.stringify(data.history));}
TaskManager.renderAllTasks();TaskManager.renderTodayTasks();alert('Tasks imported successfully!');}}catch(error){alert('Error importing file: '+error.message);}};reader.readAsText(file);});fileInput.click();menuDropdown.classList.remove('show-menu');});aboutAppLink.addEventListener('click',function(e){e.preventDefault();aboutModal.style.display='flex';menuDropdown.classList.remove('show-menu');});modalClose.addEventListener('click',function(){aboutModal.style.display='none';});aboutModal.addEventListener('click',function(e){if(e.target===aboutModal){aboutModal.style.display='none';}});function initMonthDaysGrid(){monthDaysGrid.innerHTML='';for(let i=1;i<=31;i++){const label=document.createElement('label');label.className='checkbox-label';label.innerHTML=`<input type="checkbox" name="month-day" value="${i}"> ${i}`;monthDaysGrid.appendChild(label);}}
function initQuarterDaysGrid(){quarterDaysGrid.innerHTML='';for(let i=1;i<=90;i++){const label=document.createElement('label');label.className='checkbox-label';label.innerHTML=`<input type="checkbox" name="quarter-day" value="${i}"> ${i}`;quarterDaysGrid.appendChild(label);}}
function updateYearlyDayOptions(){const month=parseInt(yearlyMonth.value);const daysInMonth=new Date(new Date().getFullYear(),month+1,0).getDate();yearlyDay.innerHTML='';for(let i=1;i<=daysInMonth;i++){const option=document.createElement('option');option.value=i;option.textContent=i;yearlyDay.appendChild(option);}}
const TaskStorage={getTasks:function(){const tasks=localStorage.getItem('recurdo-tasks');return tasks?JSON.parse(tasks):[];},saveTask:function(task){const tasks=this.getTasks();task.id=Date.now();task.createdAt=new Date().toISOString();tasks.push(task);localStorage.setItem('recurdo-tasks',JSON.stringify(tasks));return task;},updateTask:function(updatedTask){const tasks=this.getTasks();const index=tasks.findIndex(task=>task.id===updatedTask.id);if(index!==-1){tasks[index]=updatedTask;localStorage.setItem('recurdo-tasks',JSON.stringify(tasks));return true;}
return false;},deleteTask:function(taskId){let tasks=this.getTasks();tasks=tasks.filter(task=>task.id!==taskId);localStorage.setItem('recurdo-tasks',JSON.stringify(tasks));},getTaskById:function(taskId){const tasks=this.getTasks();return tasks.find(task=>task.id===taskId);},getCompletionHistory:function(){const history=localStorage.getItem('recurdo-history');return history?JSON.parse(history):{};},markTaskComplete:function(taskId,date){const dateKey=date||new Date().toISOString().split('T')[0];const history=this.getCompletionHistory();if(!history[dateKey]){history[dateKey]=[];}
if(!history[dateKey].includes(taskId)){history[dateKey].push(taskId);localStorage.setItem('recurdo-history',JSON.stringify(history));return true;}
return false;},undoTaskComplete:function(taskId,date){const dateKey=date||new Date().toISOString().split('T')[0];const history=this.getCompletionHistory();if(history[dateKey]&&history[dateKey].includes(taskId)){history[dateKey]=history[dateKey].filter(id=>id!==taskId);localStorage.setItem('recurdo-history',JSON.stringify(history));return true;}
return false;},isTaskCompleted:function(taskId,date){const dateKey=date||new Date().toISOString().split('T')[0];const history=this.getCompletionHistory();return history[dateKey]&&history[dateKey].includes(taskId);}};const DateUtils={formatDate:function(date){const d=new Date(date);return d.toISOString().split('T')[0];},today:function(){return this.formatDate(new Date());},getDayOfQuarter:function(date){const d=new Date(date);const month=d.getMonth();const quarter=Math.floor(month/3);const firstMonthOfQuarter=quarter*3;const firstDayOfQuarter=new Date(d.getFullYear(),firstMonthOfQuarter,1);const diffTime=d.getTime()-firstDayOfQuarter.getTime();const diffDays=Math.floor(diffTime/(1000*60*60*24))+1;return diffDays;},shouldTaskBeActiveOnDate:function(task,dateStr){const date=new Date(dateStr);const dayOfWeek=date.getDay();const dayOfMonth=date.getDate();const month=date.getMonth();const dayOfQuarter=this.getDayOfQuarter(date);switch(task.frequency){case'daily':return true;case'weekly':return task.weekdays.includes(dayOfWeek.toString());case'monthly':return task.monthDays.includes(dayOfMonth.toString());case'quarterly':return task.quarterDays.includes(dayOfQuarter.toString());case'yearly':return month===parseInt(task.yearlyMonth)&&dayOfMonth===parseInt(task.yearlyDay);case'custom_interval':const taskCreated=new Date(task.createdAt);const diffTime=date.getTime()-taskCreated.getTime();const diffDays=Math.floor(diffTime/(1000*60*60*24));return diffDays%task.intervalDays===0;default:return false;}}};const TaskManager={getTasksForDate:function(dateStr){const allTasks=TaskStorage.getTasks();return allTasks.filter(task=>DateUtils.shouldTaskBeActiveOnDate(task,dateStr));},getTodayTasks:function(){return this.getTasksForDate(DateUtils.today());},renderTodayTasks:function(){const tasks=this.getTodayTasks();todayTasks.innerHTML='';if(tasks.length===0){todayStatus.textContent='No tasks for today. Feel the quiet. 🧘';return;}
const completedTasks=tasks.filter(task=>TaskStorage.isTaskCompleted(task.id,DateUtils.today()));if(tasks.length-completedTasks.length===0&&tasks.length>0){todayStatus.textContent=`You're all done for today!`;}else{todayStatus.textContent=`You have ${tasks.length - completedTasks.length} out of ${tasks.length} tasks pending for today.`;};tasks.forEach(task=>{const isCompleted=TaskStorage.isTaskCompleted(task.id,DateUtils.today());const taskItem=this.createTaskItem(task,isCompleted);todayTasks.appendChild(taskItem);});this.renderUpcomingTasks(30);},renderUpcomingTasks:function(daysToShow){const upcomingTasksContainer=document.getElementById('upcoming-tasks');upcomingTasksContainer.innerHTML='';const today=new Date();today.setHours(0,0,0,0);const allTasks=TaskStorage.getTasks();const taskOccurrences={};const taskFirstDate={};for(let i=1;i<=daysToShow;i++){const futureDate=new Date(today);futureDate.setDate(today.getDate()+i);const dateStr=DateUtils.formatDate(futureDate);allTasks.forEach(task=>{if(DateUtils.shouldTaskBeActiveOnDate(task,dateStr)){if(!taskOccurrences[task.id]){taskOccurrences[task.id]=0;taskFirstDate[task.id]=dateStr;}
taskOccurrences[task.id]++;}});}
if(Object.keys(taskOccurrences).length===0){upcomingTasksContainer.innerHTML='<p class="status-message">None in the next 30 days.</p>';return;}
const upcomingTasks=Object.keys(taskOccurrences).map(taskId=>{const task=allTasks.find(t=>t.id===parseInt(taskId));const count=taskOccurrences[taskId];const firstDate=new Date(taskFirstDate[taskId]);return{task:task,count:count,firstDate:firstDate};});upcomingTasks.sort((a,b)=>a.firstDate-b.firstDate);upcomingTasks.forEach(item=>{const taskItem=document.createElement('div');taskItem.className='task-item';const formattedDate=item.firstDate.toLocaleDateString(undefined,{weekday:'short',month:'short',day:'numeric'});taskItem.innerHTML=`
          <div class="task-icon">❖</div>
          <div class="task-content">
            <small>
            <a href="#" class="task-title" data-task-id="${item.task.id}">${item.task.title}</a>
            <span class="task-frequency">${item.task.frequency}</span>
            <div class="task-description">
              ${item.count > 1 ? `<strong>x${item.count}</strong>in the next ${daysToShow}days` : `Once on ${formattedDate}`}
              <span style="margin-left: 10px; font-size: 0.9em; color: var(--text-muted);">First: ${formattedDate}</span>
            </small>
            </div>
          </div>
        `;upcomingTasksContainer.appendChild(taskItem);});},renderAllTasks:function(){const tasks=TaskStorage.getTasks();allTasks.innerHTML='';tasks.forEach(task=>{const taskElem=document.createElement('div');taskElem.className='task-item';taskElem.innerHTML=`
          <div class="task-icon">❖</div>
          <div class="task-content">
            <a href="#" class="task-title" data-task-id="${task.id}">${task.title}</a>
            <span class="task-frequency">${task.frequency}</span>
          </div>
        `;allTasks.appendChild(taskElem);});},createTaskItem:function(task,isCompleted){const taskItem=document.createElement('div');taskItem.className='task-item';taskItem.dataset.taskId=task.id;const buttonsHtml=isCompleted?`<button class="undo-btn">Undo</button>`:`<button class="done-btn">Done</button>`;taskItem.innerHTML=`
        <div class="task-icon">${isCompleted ? '■' : '□'}</div>
        <div class="task-content">
          <a href="#" class="task-title ${isCompleted ? 'completed' : ''}" data-task-id="${task.id}">${task.title}</a>
          <span class="task-frequency">${task.frequency}</span>
          
        </div>
        <div class="task-buttons">
          ${buttonsHtml}
        </div>
      `;if(isCompleted){taskItem.querySelector('.undo-btn').addEventListener('click',()=>{TaskStorage.undoTaskComplete(task.id);this.renderTodayTasks();});}else{taskItem.querySelector('.done-btn').addEventListener('click',()=>{TaskStorage.markTaskComplete(task.id);this.renderTodayTasks();});}
return taskItem;},renderTaskDetails:function(taskId){const task=TaskStorage.getTaskById(parseInt(taskId));if(!task){detailsView.innerHTML='<p>Task not found</p>';return;}
let frequencyDetails='';switch(task.frequency){case'daily':frequencyDetails='Every day';break;case'weekly':const weekdayNames=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];const days=task.weekdays.map(d=>weekdayNames[parseInt(d)]);frequencyDetails=`Weekly on ${days.join(', ')}`;break;case'monthly':frequencyDetails=`Monthly on day(s) ${task.monthDays.join(', ')}`;break;case'quarterly':frequencyDetails=`Quarterly on day(s) ${task.quarterDays.join(', ')} of each quarter`;break;case'yearly':const monthNames=['January','February','March','April','May','June','July','August','September','October','November','December'];frequencyDetails=`Yearly on ${monthNames[parseInt(task.yearlyMonth)]} ${task.yearlyDay}`;break;case'custom_interval':frequencyDetails=`Every ${task.intervalDays} days`;break;}
detailsView.innerHTML=`
        <div class="task-details">
          <h2>${task.title}</h2>
          <p><strong>Frequency:</strong> ${frequencyDetails}</p>
          ${task.description ? `<p><strong>Description:</strong>${task.description}</p>` : ''}
          <p><strong>Created:</strong> ${new Date(task.createdAt).toLocaleDateString()}</p>
          <a href="#" class="edit-link" data-task-id="${task.id}">Edit task</a>
        </div>
      `;detailsView.querySelector('.edit-link').addEventListener('click',(e)=>{e.preventDefault();this.showEditForm(task.id);});},showEditForm:function(taskId){const task=TaskStorage.getTaskById(parseInt(taskId));if(!task){editView.innerHTML='<p>Task not found</p>';return;}
const addForm=document.querySelector('.add-task-form').cloneNode(true);addForm.querySelector('h2').textContent='Edit Task';const form=addForm.querySelector('form');form.id='edit-task-form';form.dataset.taskId=task.id;form.querySelector('#task-title').value=task.title;const descField=form.querySelector('#task-description');if(descField&&task.description){descField.value=task.description;}
const freqSelect=form.querySelector('#task-frequency');freqSelect.value=task.frequency;switch(task.frequency){case'weekly':const weekdayCheckboxes=form.querySelectorAll('input[name="weekday"]');weekdayCheckboxes.forEach(cb=>{if(task.weekdays.includes(cb.value)){cb.checked=true;}});break;case'monthly':const monthDayCheckboxes=form.querySelectorAll('input[name="month-day"]');monthDayCheckboxes.forEach(cb=>{if(task.monthDays.includes(cb.value)){cb.checked=true;}});break;case'quarterly':const quarterDayCheckboxes=form.querySelectorAll('input[name="quarter-day"]');quarterDayCheckboxes.forEach(cb=>{if(task.quarterDays.includes(cb.value)){cb.checked=true;}});break;case'yearly':const monthSelect=form.querySelector('#yearly-month');monthSelect.value=task.yearlyMonth;updateYearlyDayOptions();const daySelect=form.querySelector('#yearly-day');daySelect.value=task.yearlyDay;break;case'custom_interval':form.querySelector('#interval-days').value=task.intervalDays;break;}
form.querySelectorAll('.frequency-options').forEach(opt=>{opt.classList.remove('show');if(opt.id===`${task.frequency}-options`){opt.classList.add('show');}});const deleteBtn=document.createElement('button');deleteBtn.textContent='Delete Task';deleteBtn.className='delete-btn';deleteBtn.style.marginRight='10px';form.querySelector('.submit-btn').parentNode.insertBefore(deleteBtn,form.querySelector('.submit-btn'));const cancelBtn=document.createElement('button');cancelBtn.textContent='Cancel';cancelBtn.className='cancel-btn';cancelBtn.type='button';cancelBtn.style.marginRight='10px';form.querySelector('.submit-btn').parentNode.insertBefore(cancelBtn,form.querySelector('.submit-btn'));form.querySelector('.submit-btn').textContent='Save Changes';editView.innerHTML='';editView.appendChild(addForm);form.addEventListener('submit',this.handleEditFormSubmit.bind(this));form.querySelector('#task-frequency').addEventListener('change',function(){const selectedFreq=this.value;form.querySelectorAll('.frequency-options').forEach(opt=>{opt.classList.remove('show');});if(selectedFreq){form.querySelector(`#${selectedFreq}-options`).classList.add('show');}});const yearlyMonthSelect=form.querySelector('#yearly-month');if(yearlyMonthSelect){yearlyMonthSelect.addEventListener('change',function(){const yearlyDaySelect=form.querySelector('#yearly-day');const month=parseInt(this.value);const daysInMonth=new Date(new Date().getFullYear(),month+1,0).getDate();yearlyDaySelect.innerHTML='';for(let i=1;i<=daysInMonth;i++){const option=document.createElement('option');option.value=i;option.textContent=i;yearlyDaySelect.appendChild(option);}});}
deleteBtn.addEventListener('click',(e)=>{e.preventDefault();if(confirm('Are you sure you want to delete this task?')){TaskStorage.deleteTask(parseInt(task.id));setActiveView('all');this.renderAllTasks();this.renderTodayTasks();}});cancelBtn.addEventListener('click',(e)=>{e.preventDefault();setActiveView('all');});setActiveView('edit');},handleEditFormSubmit:function(e){e.preventDefault();const form=e.target;const taskId=parseInt(form.dataset.taskId);const task=TaskStorage.getTaskById(taskId);if(!task){alert('Task not found');return;}
const title=form.querySelector('#task-title').value;const description=form.querySelector('#task-description').value;const frequency=form.querySelector('#task-frequency').value;const updatedTask={...task,title,description,frequency};switch(frequency){case'weekly':const weekdays=[];form.querySelectorAll('input[name="weekday"]:checked').forEach(cb=>{weekdays.push(cb.value);});if(weekdays.length===0){alert('Please select at least one day of the week.');return;}
updatedTask.weekdays=weekdays;break;case'monthly':const monthDays=[];form.querySelectorAll('input[name="month-day"]:checked').forEach(cb=>{monthDays.push(cb.value);});if(monthDays.length===0){alert('Please select at least one day of the month.');return;}
updatedTask.monthDays=monthDays;break;case'quarterly':const quarterDays=[];form.querySelectorAll('input[name="quarter-day"]:checked').forEach(cb=>{quarterDays.push(cb.value);});if(quarterDays.length===0){alert('Please select at least one day of the quarter.');return;}
updatedTask.quarterDays=quarterDays;break;case'yearly':updatedTask.yearlyMonth=form.querySelector('#yearly-month').value;updatedTask.yearlyDay=form.querySelector('#yearly-day').value;break;case'custom_interval':const intervalDays=parseInt(form.querySelector('#interval-days').value);if(intervalDays<1){alert('Please enter a valid interval (minimum 1 day).');return;}
updatedTask.intervalDays=intervalDays;break;}
if(TaskStorage.updateTask(updatedTask)){this.renderAllTasks();this.renderTodayTasks();this.renderTaskDetails(taskId);setActiveView('details');}else{alert('Failed to update task');}},handleNewTaskSubmit:function(e){e.preventDefault();const form=e.target;const title=form.querySelector('#task-title').value;const description=form.querySelector('#task-description').value;const frequency=form.querySelector('#task-frequency').value;if(!title||!frequency){alert('Please fill out all required fields');return;}
const task={title,description,frequency};switch(frequency){case'daily':break;case'weekly':const weekdays=[];form.querySelectorAll('input[name="weekday"]:checked').forEach(cb=>{weekdays.push(cb.value);});if(weekdays.length===0){alert('Please select at least one day of the week.');return;}
task.weekdays=weekdays;break;case'monthly':const monthDays=[];form.querySelectorAll('input[name="month-day"]:checked').forEach(cb=>{monthDays.push(cb.value);});if(monthDays.length===0){alert('Please select at least one day of the month.');return;}
task.monthDays=monthDays;break;case'quarterly':const quarterDays=[];form.querySelectorAll('input[name="quarter-day"]:checked').forEach(cb=>{quarterDays.push(cb.value);});if(quarterDays.length===0){alert('Please select at least one day of the quarter.');return;}
task.quarterDays=quarterDays;break;case'yearly':task.yearlyMonth=form.querySelector('#yearly-month').value;task.yearlyDay=form.querySelector('#yearly-day').value;break;case'custom_interval':const intervalDays=parseInt(form.querySelector('#interval-days').value);if(intervalDays<1){alert('Please enter a valid interval (minimum 1 day).');return;}
task.intervalDays=intervalDays;break;}
TaskStorage.saveTask(task);form.reset();form.querySelectorAll('.frequency-options').forEach(opt=>{opt.classList.remove('show');});setActiveView('today');this.renderTodayTasks();this.renderAllTasks();}};initMonthDaysGrid();initQuarterDaysGrid();updateYearlyDayOptions();yearlyMonth.addEventListener('change',updateYearlyDayOptions);function setActiveView(viewName){for(let i=0;i<tabs.length;i++){const tab=tabs[i];if(tab.dataset.view===viewName){tab.classList.add('active');}else{tab.classList.remove('active');}}
for(let i=0;i<views.length;i++){const view=views[i];if(view.id===`${viewName}-view`){view.classList.remove('hidden');}else{view.classList.add('hidden');}}
if(viewName==='today'){TaskManager.renderUpcomingTasks(30);}}
tabs.forEach(function(tab){tab.addEventListener('click',function(){const viewName=tab.dataset.view;setActiveView(viewName);if(viewName==='today'){TaskManager.renderTodayTasks();}else if(viewName==='all'){TaskManager.renderAllTasks();}});});taskFrequency.addEventListener('change',function(){const selectedFreq=this.value;frequencyOptions.forEach(opt=>{opt.classList.remove('show');});if(selectedFreq){const optionsElement=document.getElementById(`${selectedFreq}-options`);if(optionsElement){optionsElement.classList.add('show');}}});taskForm.addEventListener('submit',(e)=>{TaskManager.handleNewTaskSubmit(e);});todayTasks.addEventListener('click',(e)=>{if(e.target.classList.contains('task-title')){e.preventDefault();const taskId=e.target.dataset.taskId;TaskManager.renderTaskDetails(taskId);setActiveView('details');}});const upcomingTasks=document.getElementById('upcoming-tasks');upcomingTasks.addEventListener('click',(e)=>{if(e.target.classList.contains('task-title')){e.preventDefault();const taskId=e.target.dataset.taskId;TaskManager.renderTaskDetails(taskId);setActiveView('details');}});allTasks.addEventListener('click',(e)=>{if(e.target.classList.contains('task-title')){e.preventDefault();const taskId=e.target.dataset.taskId;TaskManager.renderTaskDetails(taskId);setActiveView('details');}});TaskManager.renderTodayTasks();TaskManager.renderAllTasks();});</script></body></html>